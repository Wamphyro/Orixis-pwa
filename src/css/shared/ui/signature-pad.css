/* ========================================
   SIGNATURE-PAD.CSS - Styles pour le composant SignaturePad
   Chemin: src/css/shared/ui/signature-pad.css
   
   DESCRIPTION:
   Styles complets pour le composant de signature avec support
   glassmorphism et toutes les variantes de styles.
   
   STRUCTURE:
   1. Variables et configuration (lignes 20-120)
   2. Conteneur principal (lignes 122-250)
   3. Canvas et wrapper (lignes 252-450)
   4. Placeholder et guides (lignes 452-600)
   5. Toolbar et boutons (lignes 602-850)
   6. Color picker (lignes 852-950)
   7. Status bar (lignes 952-1050)
   8. Styles par thème (lignes 1052-1350)
   9. États et animations (lignes 1352-1550)
   10. Responsive (lignes 1552-1650)
   11. Accessibilité (lignes 1652-1750)
   
   DÉPENDANCES:
   - Variables globales du thème
   - Animations partagées
   ======================================== */

/* ========================================
   VARIABLES ET CONFIGURATION
   ======================================== */
:root {
    /* Couleurs glassmorphism */
    --sp-glass-bg: rgba(255, 255, 255, 0.08);
    --sp-glass-bg-hover: rgba(255, 255, 255, 0.12);
    --sp-glass-border: rgba(255, 255, 255, 0.15);
    --sp-glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    --sp-backdrop-blur: 20px;
    
    /* Couleurs de base */
    --sp-primary: #3b82f6;
    --sp-primary-hover: #2563eb;
    --sp-secondary: #6b7280;
    --sp-danger: #ef4444;
    --sp-success: #22c55e;
    --sp-text: #1f2937;
    --sp-text-secondary: #6b7280;
    --sp-bg: #ffffff;
    --sp-border: #e5e7eb;
    
    /* Couleurs de trait */
    --sp-stroke-black: #000000;
    --sp-stroke-blue: #0066cc;
    --sp-stroke-red: #cc0000;
    --sp-stroke-green: #00cc66;
    
    /* Espacement */
    --sp-spacing-xs: 4px;
    --sp-spacing-sm: 8px;
    --sp-spacing-md: 12px;
    --sp-spacing-lg: 16px;
    --sp-spacing-xl: 20px;
    
    /* Dimensions */
    --sp-toolbar-height: 48px;
    --sp-button-size: 36px;
    --sp-color-size: 28px;
    
    /* Transitions */
    --sp-transition-speed: 0.3s;
    --sp-transition-easing: cubic-bezier(0.4, 0, 0.2, 1);
    
    /* Border radius */
    --sp-radius-sm: 4px;
    --sp-radius-md: 8px;
    --sp-radius-lg: 12px;
    --sp-radius-xl: 16px;
    
    /* Z-index */
    --sp-z-placeholder: 1;
    --sp-z-guides: 2;
    --sp-z-canvas: 3;
    --sp-z-toolbar: 4;
}

/* Mode sombre */
@media (prefers-color-scheme: dark) {
    :root {
        --sp-glass-bg: rgba(255, 255, 255, 0.05);
        --sp-glass-bg-hover: rgba(255, 255, 255, 0.08);
        --sp-glass-border: rgba(255, 255, 255, 0.1);
        --sp-glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        --sp-text: #f3f4f6;
        --sp-text-secondary: #9ca3af;
        --sp-bg: #1f2937;
        --sp-border: #374151;
    }
}

/* ========================================
   CONTENEUR PRINCIPAL
   ======================================== */
.signature-pad {
    position: relative;
    display: flex;
    flex-direction: column;
    width: 100%;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    font-size: 14px;
    color: var(--sp-text);
    transition: opacity var(--sp-transition-speed) var(--sp-transition-easing);
}

.signature-pad * {
    box-sizing: border-box;
}

/* Styles glassmorphism */
.signature-pad.glassmorphism {
    background: var(--sp-glass-bg);
    backdrop-filter: blur(var(--sp-backdrop-blur)) brightness(1.1);
    -webkit-backdrop-filter: blur(var(--sp-backdrop-blur)) brightness(1.1);
    border: 1px solid var(--sp-glass-border);
    border-radius: var(--sp-radius-xl);
    box-shadow: var(--sp-glass-shadow),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                inset 0 -1px 0 rgba(0, 0, 0, 0.1);
    padding: var(--sp-spacing-lg);
}

/* Effet de brillance pour glassmorphism */
.signature-pad.glassmorphism::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.1) 0%,
        rgba(255, 255, 255, 0) 40%,
        rgba(255, 255, 255, 0) 60%,
        rgba(255, 255, 255, 0.05) 100%
    );
    pointer-events: none;
}

/* Tailles */
.signature-pad.small {
    max-width: 300px;
}

.signature-pad.medium {
    max-width: 500px;
}

.signature-pad.large {
    max-width: 700px;
}

.signature-pad.fullwidth {
    max-width: 100%;
}

.signature-pad.square {
    max-width: 400px;
}

/* ========================================
   CANVAS ET WRAPPER
   ======================================== */
.signature-pad-canvas-wrapper {
    position: relative;
    width: 100%;
    background: var(--sp-bg);
    border: 1px solid var(--sp-border);
    border-radius: var(--sp-radius-md);
    overflow: hidden;
    transition: all var(--sp-transition-speed) var(--sp-transition-easing);
}

/* Canvas styles selon le thème */
.signature-pad.glassmorphism .signature-pad-canvas-wrapper {
    background: rgba(255, 255, 255, 0.05);
    border-color: var(--sp-glass-border);
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
}

.signature-pad-canvas {
    display: block;
    width: 100%;
    cursor: crosshair;
    touch-action: none;
    user-select: none;
    -webkit-user-select: none;
    position: relative;
    z-index: var(--sp-z-canvas);
}

/* États du canvas */
.signature-pad.is-drawing .signature-pad-canvas {
    cursor: crosshair;
}

.signature-pad.is-disabled .signature-pad-canvas {
    cursor: not-allowed;
    opacity: 0.5;
}

/* Styles spéciaux */
.signature-pad.paper .signature-pad-canvas-wrapper {
    background: #fffef7;
    background-image: 
        repeating-linear-gradient(
            0deg,
            transparent,
            transparent 28px,
            #e5e5e5 28px,
            #e5e5e5 29px
        );
    box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
}

.signature-pad.chalkboard .signature-pad-canvas-wrapper {
    background: #2d3436;
    background-image: 
        radial-gradient(circle at 20% 80%, rgba(255, 255, 255, 0.03) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.03) 0%, transparent 50%);
    border: 4px solid #574b3d;
    border-radius: 4px;
}

/* ========================================
   PLACEHOLDER ET GUIDES
   ======================================== */
.signature-pad-placeholder {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 24px;
    font-style: italic;
    color: var(--sp-text-secondary);
    opacity: 0.5;
    pointer-events: none;
    z-index: var(--sp-z-placeholder);
    transition: opacity var(--sp-transition-speed) var(--sp-transition-easing);
}

.signature-pad.glassmorphism .signature-pad-placeholder {
    color: rgba(255, 255, 255, 0.5);
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.signature-pad.chalkboard .signature-pad-placeholder {
    color: rgba(255, 255, 255, 0.3);
    font-family: 'Comic Sans MS', cursive;
}

/* Guides */
.signature-pad-guide {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: var(--sp-z-guides);
}

.signature-pad-guide line {
    stroke: rgba(0, 0, 0, 0.1);
    stroke-width: 1;
    stroke-dasharray: 5, 5;
}

.signature-pad.glassmorphism .signature-pad-guide line {
    stroke: rgba(255, 255, 255, 0.2);
}

/* ========================================
   TOOLBAR ET BOUTONS
   ======================================== */
.signature-pad-toolbar {
    display: flex;
    align-items: center;
    gap: var(--sp-spacing-sm);
    height: var(--sp-toolbar-height);
    padding: 0 var(--sp-spacing-sm);
    margin-top: var(--sp-spacing-md);
    background: var(--sp-bg);
    border: 1px solid var(--sp-border);
    border-radius: var(--sp-radius-md);
}

.signature-pad.glassmorphism .signature-pad-toolbar {
    background: var(--sp-glass-bg);
    border-color: var(--sp-glass-border);
    backdrop-filter: blur(10px);
}

/* Boutons */
.signature-pad-button {
    display: flex;
    align-items: center;
    justify-content: center;
    width: var(--sp-button-size);
    height: var(--sp-button-size);
    padding: 0;
    background: transparent;
    border: 1px solid transparent;
    border-radius: var(--sp-radius-md);
    color: var(--sp-text-secondary);
    cursor: pointer;
    transition: all var(--sp-transition-speed) var(--sp-transition-easing);
}

.signature-pad-button:hover {
    background: var(--sp-glass-bg-hover);
    border-color: var(--sp-glass-border);
    color: var(--sp-primary);
}

.signature-pad-button:active {
    transform: scale(0.95);
}

.signature-pad-button svg {
    width: 20px;
    height: 20px;
}

/* États des boutons */
.signature-pad-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.signature-pad-button:disabled:hover {
    background: transparent;
    color: var(--sp-text-secondary);
}

/* Boutons glassmorphism */
.signature-pad.glassmorphism .signature-pad-button {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.1);
}

.signature-pad.glassmorphism .signature-pad-button:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.2);
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
}

/* Séparateur dans la toolbar */
.signature-pad-toolbar::before {
    content: '';
    position: absolute;
    left: 0;
    right: 0;
    bottom: 100%;
    height: 1px;
    background: linear-gradient(
        to right,
        transparent,
        var(--sp-border) 20%,
        var(--sp-border) 80%,
        transparent
    );
    margin-bottom: var(--sp-spacing-sm);
}

/* ========================================
   COLOR PICKER
   ======================================== */
.signature-pad-color {
    display: flex;
    align-items: center;
    gap: var(--sp-spacing-xs);
    margin-left: auto;
    padding: var(--sp-spacing-xs);
    background: var(--sp-bg);
    border: 1px solid var(--sp-border);
    border-radius: var(--sp-radius-md);
}

.signature-pad.glassmorphism .signature-pad-color {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.1);
}

.signature-pad-color-option {
    width: var(--sp-color-size);
    height: var(--sp-color-size);
    padding: 0;
    border: 2px solid transparent;
    border-radius: 50%;
    cursor: pointer;
    transition: all var(--sp-transition-speed) var(--sp-transition-easing);
    position: relative;
    overflow: hidden;
}

.signature-pad-color-option::before {
    content: '';
    position: absolute;
    inset: 2px;
    border-radius: 50%;
    background: inherit;
}

.signature-pad-color-option:hover {
    transform: scale(1.1);
    border-color: var(--sp-primary);
}

.signature-pad-color-option.active {
    border-color: var(--sp-primary);
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
}

/* Input couleur personnalisée */
.signature-pad-color-custom {
    width: var(--sp-color-size);
    height: var(--sp-color-size);
    padding: 0;
    border: 2px dashed var(--sp-border);
    border-radius: 50%;
    cursor: pointer;
    background: transparent;
}

.signature-pad-color-custom::-webkit-color-swatch-wrapper {
    padding: 2px;
}

.signature-pad-color-custom::-webkit-color-swatch {
    border: none;
    border-radius: 50%;
}

/* ========================================
   STATUS BAR
   ======================================== */
.signature-pad-status {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--sp-spacing-md);
    padding: var(--sp-spacing-sm) var(--sp-spacing-md);
    margin-top: var(--sp-spacing-sm);
    font-size: 12px;
    color: var(--sp-text-secondary);
    background: var(--sp-bg);
    border: 1px solid var(--sp-border);
    border-radius: var(--sp-radius-sm);
}

.signature-pad.glassmorphism .signature-pad-status {
    background: rgba(255, 255, 255, 0.03);
    border-color: rgba(255, 255, 255, 0.1);
}

.signature-pad-status-points,
.signature-pad-status-time {
    display: flex;
    align-items: center;
    gap: var(--sp-spacing-xs);
}

/* ========================================
   STYLES PAR THÈME
   ======================================== */

/* Neumorphism */
.signature-pad.neumorphism {
    background: #e0e5ec;
    border: none;
    box-shadow: 20px 20px 40px #a3b1c6, -20px -20px 40px #ffffff;
    border-radius: 20px;
    padding: 20px;
}

.signature-pad.neumorphism .signature-pad-canvas-wrapper {
    background: #e0e5ec;
    border: none;
    box-shadow: inset 6px 6px 12px #a3b1c6, inset -6px -6px 12px #ffffff;
}

.signature-pad.neumorphism .signature-pad-button {
    background: #e0e5ec;
    box-shadow: 5px 5px 10px #a3b1c6, -5px -5px 10px #ffffff;
}

.signature-pad.neumorphism .signature-pad-button:hover {
    box-shadow: inset 2px 2px 5px #a3b1c6, inset -2px -2px 5px #ffffff;
}

/* Flat */
.signature-pad.flat {
    background: transparent;
    border: none;
    box-shadow: none;
    padding: 0;
}

.signature-pad.flat .signature-pad-toolbar {
    background: #f3f4f6;
    border-color: #e5e7eb;
}

/* Minimal */
.signature-pad.minimal {
    background: transparent;
    border: none;
    padding: 0;
}

.signature-pad.minimal .signature-pad-canvas-wrapper {
    background: transparent;
    border: none;
    border-bottom: 2px solid var(--sp-border);
    border-radius: 0;
}

.signature-pad.minimal .signature-pad-toolbar {
    background: transparent;
    border: none;
    border-top: 1px solid var(--sp-border);
    border-radius: 0;
}

/* Material */
.signature-pad.material {
    background: #ffffff;
    border-radius: 4px;
    box-shadow: 0 3px 5px -1px rgba(0,0,0,.2),
                0 6px 10px 0 rgba(0,0,0,.14),
                0 1px 18px 0 rgba(0,0,0,.12);
    padding: 16px;
}

.signature-pad.material .signature-pad-canvas-wrapper {
    box-shadow: 0 1px 3px rgba(0,0,0,0.12);
}

/* ========================================
   ÉTATS ET ANIMATIONS
   ======================================== */

/* État vide */
.signature-pad.is-empty .signature-pad-placeholder {
    opacity: 1;
}

/* État de dessin */
.signature-pad.is-drawing .signature-pad-canvas-wrapper {
    border-color: var(--sp-primary);
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

/* État signé */
.signature-pad.is-signed .signature-pad-canvas-wrapper {
    border-color: var(--sp-success);
}

/* État invalide */
.signature-pad.is-invalid .signature-pad-canvas-wrapper {
    border-color: var(--sp-danger);
    animation: shake 0.5s ease-in-out;
}

@keyframes shake {
    0%, 100% { transform: translateX(0); }
    10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); }
    20%, 40%, 60%, 80% { transform: translateX(2px); }
}

/* État sauvegardé */
.signature-pad.is-saved::after {
    content: '✓';
    position: absolute;
    top: var(--sp-spacing-sm);
    right: var(--sp-spacing-sm);
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--sp-success);
    color: white;
    border-radius: 50%;
    font-size: 18px;
    animation: savedPulse 2s ease-out;
    pointer-events: none;
}

@keyframes savedPulse {
    0% {
        transform: scale(0);
        opacity: 0;
    }
    50% {
        transform: scale(1.2);
        opacity: 1;
    }
    100% {
        transform: scale(1);
        opacity: 0;
    }
}

/* Animation de chargement */
.signature-pad.is-loading {
    pointer-events: none;
}

.signature-pad.is-loading::before {
    content: '';
    position: absolute;
    inset: 0;
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(2px);
    border-radius: inherit;
    z-index: 10;
}

.signature-pad.is-loading::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 32px;
    height: 32px;
    margin: -16px 0 0 -16px;
    border: 3px solid var(--sp-primary);
    border-right-color: transparent;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    z-index: 11;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* Effet ripple pour les touches */
.signature-pad-ripple {
    position: absolute;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(59, 130, 246, 0.3) 0%, transparent 70%);
    transform: scale(0);
    animation: ripple 0.6s ease-out;
    pointer-events: none;
}

@keyframes ripple {
    to {
        transform: scale(4);
        opacity: 0;
    }
}

/* ========================================
   RESPONSIVE
   ======================================== */
@media (max-width: 640px) {
    .signature-pad {
        padding: var(--sp-spacing-md);
    }
    
    .signature-pad-placeholder {
        font-size: 18px;
    }
    
    .signature-pad-toolbar {
        height: 44px;
        padding: 0 var(--sp-spacing-xs);
    }
    
    .signature-pad-button {
        width: 32px;
        height: 32px;
    }
    
    .signature-pad-button svg {
        width: 18px;
        height: 18px;
    }
    
    .signature-pad-color-option,
    .signature-pad-color-custom {
        width: 24px;
        height: 24px;
    }
}

/* Mode paysage mobile */
@media (max-height: 500px) and (orientation: landscape) {
    .signature-pad-canvas-wrapper {
        max-height: 200px;
    }
    
    .signature-pad-toolbar {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        margin: 0;
        border-radius: 0 0 var(--sp-radius-md) var(--sp-radius-md);
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
    }
}

/* Touch devices */
@media (hover: none) {
    .signature-pad-button:active {
        transform: scale(0.95);
        transition-duration: 0.05s;
    }
    
    .signature-pad-color-option:active {
        transform: scale(0.9);
    }
}

/* ========================================
   ACCESSIBILITÉ
   ======================================== */

/* Focus visible */
.signature-pad-canvas:focus-visible {
    outline: 2px solid var(--sp-primary);
    outline-offset: 2px;
}

.signature-pad-button:focus-visible,
.signature-pad-color-option:focus-visible {
    outline: 2px solid var(--sp-primary);
    outline-offset: 2px;
}

/* Mode contraste élevé */
@media (prefers-contrast: high) {
    .signature-pad {
        border-width: 2px;
    }
    
    .signature-pad-canvas-wrapper {
        border-width: 2px;
    }
    
    .signature-pad.glassmorphism {
        background: var(--sp-bg);
        backdrop-filter: none;
    }
}

/* Préférences de mouvement réduit */
@media (prefers-reduced-motion: reduce) {
    .signature-pad,
    .signature-pad * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* ========================================
   SUPPORT NAVIGATEURS
   ======================================== */

/* Fallback pour navigateurs sans backdrop-filter */
@supports not (backdrop-filter: blur(20px)) {
    .signature-pad.glassmorphism {
        background: rgba(255, 255, 255, 0.95);
    }
    
    .dark .signature-pad.glassmorphism {
        background: rgba(30, 30, 30, 0.95);
    }
    
    .signature-pad.glassmorphism .signature-pad-toolbar,
    .signature-pad.glassmorphism .signature-pad-button {
        background: rgba(255, 255, 255, 0.9);
    }
}

/* Support du thème sombre */
.signature-pad[data-theme="dark"],
.dark .signature-pad {
    --sp-text: #f3f4f6;
    --sp-text-secondary: #9ca3af;
    --sp-bg: #1f2937;
    --sp-border: #374151;
    --sp-glass-bg: rgba(255, 255, 255, 0.05);
    --sp-glass-bg-hover: rgba(255, 255, 255, 0.08);
    --sp-glass-border: rgba(255, 255, 255, 0.1);
}