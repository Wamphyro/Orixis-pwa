/* ========================================
   AVATAR.CSS - Styles pour le composant Avatar
   Chemin: src/css/shared/ui/avatar.css
   
   DESCRIPTION:
   Styles complets pour le système d'avatars avec effet glassmorphism.
   Supporte images, initiales, icônes, statuts, badges et groupes.
   
   STRUCTURE:
   1. Variables et configuration (lignes 20-100)
   2. Styles de base (lignes 102-250)
   3. Types d'avatar (lignes 252-400)
   4. Tailles (lignes 402-550)
   5. Formes (lignes 552-650)
   6. Statuts et badges (lignes 652-850)
   7. Groupes d'avatars (lignes 852-950)
   8. Animations (lignes 952-1100)
   9. Responsive et thèmes (lignes 1102-1200)
   
   DÉPENDANCES:
   - avatar.component.js (utilise toutes ces classes)
   ======================================== */

/* ========================================
   VARIABLES ET CONFIGURATION
   ======================================== */
:root {
    /* Couleurs glassmorphism */
    --avatar-glass-bg: rgba(255, 255, 255, 0.1);
    --avatar-glass-bg-hover: rgba(255, 255, 255, 0.15);
    --avatar-glass-border: rgba(255, 255, 255, 0.2);
    --avatar-glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    --avatar-backdrop-blur: 20px;
    
    /* Tailles par défaut */
    --avatar-size-xs: 24px;
    --avatar-size-sm: 32px;
    --avatar-size-md: 40px;
    --avatar-size-lg: 56px;
    --avatar-size-xl: 72px;
    --avatar-size-xxl: 96px;
    
    /* Couleurs de statut */
    --avatar-status-online: #22c55e;
    --avatar-status-offline: #6b7280;
    --avatar-status-busy: #ef4444;
    --avatar-status-away: #f59e0b;
    
    /* Badge */
    --avatar-badge-bg: #ef4444;
    --avatar-badge-color: #ffffff;
    --avatar-badge-size: 20px;
    
    /* Typographie */
    --avatar-font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    --avatar-font-weight: 600;
    
    /* Transitions */
    --avatar-transition-speed: 0.3s;
    --avatar-transition-easing: cubic-bezier(0.4, 0, 0.2, 1);
    
    /* Z-index */
    --avatar-badge-z: 10;
    --avatar-status-z: 10;
}

/* Mode sombre */
@media (prefers-color-scheme: dark) {
    :root {
        --avatar-glass-bg: rgba(255, 255, 255, 0.05);
        --avatar-glass-bg-hover: rgba(255, 255, 255, 0.08);
        --avatar-glass-border: rgba(255, 255, 255, 0.1);
        --avatar-glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }
}

/* ========================================
   STYLES DE BASE
   ======================================== */
.avatar {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: var(--avatar-size-md);
    height: var(--avatar-size-md);
    font-family: var(--avatar-font-family);
    font-weight: var(--avatar-font-weight);
    overflow: hidden;
    user-select: none;
    transition: all var(--avatar-transition-speed) var(--avatar-transition-easing);
}

/* Style Glassmorphism par défaut */
.avatar.glassmorphism,
.avatar:not([class*="neumorphism"]):not([class*="flat"]):not([class*="minimal"]):not([class*="material"]) {
    background: var(--avatar-glass-bg);
    backdrop-filter: blur(var(--avatar-backdrop-blur)) brightness(1.1);
    -webkit-backdrop-filter: blur(var(--avatar-backdrop-blur)) brightness(1.1);
    border: 1px solid var(--avatar-glass-border);
    box-shadow: var(--avatar-glass-shadow),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                inset 0 -1px 0 rgba(0, 0, 0, 0.05);
}

/* Effet de brillance glassmorphism */
.avatar.glassmorphism::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.15) 0%,
        rgba(255, 255, 255, 0) 40%,
        rgba(255, 255, 255, 0) 60%,
        rgba(255, 255, 255, 0.1) 100%
    );
    pointer-events: none;
}

/* Contenu de l'avatar */
.avatar-content {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    z-index: 1;
}

/* Style Neumorphism */
.avatar.neumorphism {
    background: #e0e5ec;
    box-shadow: 9px 9px 16px #a3b1c6, -9px -9px 16px #ffffff;
}

/* Style Flat */
.avatar.flat {
    background: #f3f4f6;
    border: 1px solid #e5e7eb;
}

/* Style Minimal */
.avatar.minimal {
    background: transparent;
    border: 2px solid currentColor;
}

/* Style Material */
.avatar.material {
    background: #ffffff;
    box-shadow: 0 3px 5px -1px rgba(0,0,0,.2),
                0 6px 10px 0 rgba(0,0,0,.14),
                0 1px 18px 0 rgba(0,0,0,.12);
}

/* États interactifs */
.avatar[onclick],
.avatar[style*="cursor: pointer"] {
    cursor: pointer;
}

.avatar[onclick]:hover,
.avatar[style*="cursor: pointer"]:hover {
    transform: scale(1.05);
    box-shadow: var(--avatar-glass-shadow),
                0 12px 40px rgba(0, 0, 0, 0.15);
}

.avatar[onclick]:active,
.avatar[style*="cursor: pointer"]:active {
    transform: scale(0.98);
}

/* ========================================
   TYPES D'AVATAR
   ======================================== */

/* Image */
.avatar-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
}

/* Initiales */
.avatar-initials {
    font-size: 0.4em;
    line-height: 1;
    text-transform: uppercase;
    color: rgba(255, 255, 255, 0.9);
}

/* Pour fond coloré avec initiales */
.avatar-content[style*="background-color"] {
    background-blend-mode: overlay;
}

.avatar-content[style*="background-color"] .avatar-initials {
    color: #ffffff;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

/* Icône */
.avatar-icon {
    width: 50%;
    height: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: rgba(255, 255, 255, 0.8);
}

.avatar-icon svg {
    width: 100%;
    height: 100%;
    stroke-width: 1.5;
}

/* Placeholder */
.avatar-placeholder {
    width: 50%;
    height: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: rgba(255, 255, 255, 0.6);
}

.avatar-placeholder svg {
    width: 100%;
    height: 100%;
    stroke-width: 1.5;
}

/* ========================================
   TAILLES
   ======================================== */

/* Extra Small */
.avatar-xs {
    width: var(--avatar-size-xs);
    height: var(--avatar-size-xs);
    font-size: 10px;
}

.avatar-xs.avatar-circle,
.avatar-xs.avatar-rounded {
    border-radius: 6px;
}

/* Small */
.avatar-small {
    width: var(--avatar-size-sm);
    height: var(--avatar-size-sm);
    font-size: 12px;
}

.avatar-small.avatar-circle,
.avatar-small.avatar-rounded {
    border-radius: 8px;
}

/* Medium (par défaut) */
.avatar-medium {
    width: var(--avatar-size-md);
    height: var(--avatar-size-md);
    font-size: 14px;
}

/* Large */
.avatar-large {
    width: var(--avatar-size-lg);
    height: var(--avatar-size-lg);
    font-size: 18px;
}

.avatar-large.avatar-circle,
.avatar-large.avatar-rounded {
    border-radius: 14px;
}

/* Extra Large */
.avatar-xl {
    width: var(--avatar-size-xl);
    height: var(--avatar-size-xl);
    font-size: 24px;
}

.avatar-xl.avatar-circle,
.avatar-xl.avatar-rounded {
    border-radius: 18px;
}

/* Extra Extra Large */
.avatar-xxl {
    width: var(--avatar-size-xxl);
    height: var(--avatar-size-xxl);
    font-size: 32px;
}

.avatar-xxl.avatar-circle,
.avatar-xxl.avatar-rounded {
    border-radius: 24px;
}

/* ========================================
   FORMES
   ======================================== */

/* Circle (par défaut) */
.avatar-circle,
.avatar:not(.avatar-square):not(.avatar-rounded):not(.avatar-hexagon) {
    border-radius: 50%;
}

/* Square */
.avatar-square {
    border-radius: 0;
}

/* Rounded */
.avatar-rounded {
    border-radius: 16px;
}

/* Hexagon */
.avatar-hexagon {
    clip-path: polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%);
}

/* ========================================
   STATUTS
   ======================================== */
.avatar-status {
    position: absolute;
    width: 25%;
    height: 25%;
    min-width: 8px;
    min-height: 8px;
    border-radius: 50%;
    border: 2px solid var(--avatar-glass-bg);
    z-index: var(--avatar-status-z);
    transition: all var(--avatar-transition-speed) var(--avatar-transition-easing);
}

/* Positions des statuts */
.avatar-status.position-top-right {
    top: 0;
    right: 0;
    transform: translate(25%, -25%);
}

.avatar-status.position-top-left {
    top: 0;
    left: 0;
    transform: translate(-25%, -25%);
}

.avatar-status.position-bottom-right {
    bottom: 0;
    right: 0;
    transform: translate(25%, 25%);
}

.avatar-status.position-bottom-left {
    bottom: 0;
    left: 0;
    transform: translate(-25%, 25%);
}

/* Couleurs de statut */
.avatar-status-online {
    background-color: var(--avatar-status-online);
}

.avatar-status-offline {
    background-color: var(--avatar-status-offline);
}

.avatar-status-busy {
    background-color: var(--avatar-status-busy);
}

.avatar-status-away {
    background-color: var(--avatar-status-away);
}

.avatar-status-invisible {
    background-color: var(--avatar-status-offline);
    opacity: 0.5;
}

/* Animation pulse pour certains statuts */
.avatar-status.status-pulse::after {
    content: '';
    position: absolute;
    inset: -2px;
    border-radius: inherit;
    background: inherit;
    opacity: 0.6;
    animation: statusPulse 2s ease-in-out infinite;
}

@keyframes statusPulse {
    0% {
        transform: scale(1);
        opacity: 0.6;
    }
    50% {
        transform: scale(1.5);
        opacity: 0;
    }
    100% {
        transform: scale(1);
        opacity: 0;
    }
}

/* ========================================
   BADGES
   ======================================== */
.avatar-badge {
    position: absolute;
    min-width: var(--avatar-badge-size);
    height: var(--avatar-badge-size);
    padding: 0 6px;
    background: var(--avatar-badge-bg);
    color: var(--avatar-badge-color);
    font-size: 11px;
    font-weight: 700;
    line-height: var(--avatar-badge-size);
    text-align: center;
    border-radius: calc(var(--avatar-badge-size) / 2);
    border: 2px solid var(--avatar-glass-bg);
    z-index: var(--avatar-badge-z);
    white-space: nowrap;
    transition: all var(--avatar-transition-speed) var(--avatar-transition-easing);
}

/* Positions des badges */
.avatar-badge.position-top-right {
    top: 0;
    right: 0;
    transform: translate(50%, -50%);
}

.avatar-badge.position-top-left {
    top: 0;
    left: 0;
    transform: translate(-50%, -50%);
}

.avatar-badge.position-bottom-right {
    bottom: 0;
    right: 0;
    transform: translate(50%, 50%);
}

.avatar-badge.position-bottom-left {
    bottom: 0;
    left: 0;
    transform: translate(-50%, 50%);
}

/* Types de badges */
.avatar-badge.badge-success {
    background: var(--avatar-status-online);
}

.avatar-badge.badge-warning {
    background: var(--avatar-status-away);
}

.avatar-badge.badge-info {
    background: #3b82f6;
}

/* ========================================
   GROUPES D'AVATARS
   ======================================== */
.avatar-group {
    display: inline-flex;
    align-items: center;
}

.avatar-group .avatar {
    border: 2px solid var(--avatar-glass-bg);
    transition: all var(--avatar-transition-speed) var(--avatar-transition-easing);
}

.avatar-group .avatar:hover {
    z-index: 20 !important;
    transform: scale(1.1) translateY(-2px);
}

/* Tailles de groupe */
.avatar-group-small .avatar {
    width: var(--avatar-size-sm);
    height: var(--avatar-size-sm);
}

.avatar-group-large .avatar {
    width: var(--avatar-size-lg);
    height: var(--avatar-size-lg);
}

/* Avatar de compteur (+X) */
.avatar-group .avatar:has(.avatar-initials:first-child:last-child) {
    background: rgba(107, 114, 128, 0.1);
    backdrop-filter: blur(10px);
    color: #6b7280;
}

/* ========================================
   ANIMATIONS
   ======================================== */

/* Pulse */
@keyframes avatarPulse {
    0%, 100% {
        transform: scale(1);
        opacity: 1;
    }
    50% {
        transform: scale(1.05);
        opacity: 0.8;
    }
}

.avatar.animate-pulse {
    animation: avatarPulse 2s ease-in-out infinite;
}

/* Bounce */
@keyframes avatarBounce {
    0%, 100% {
        transform: translateY(0);
    }
    25% {
        transform: translateY(-4px);
    }
    75% {
        transform: translateY(2px);
    }
}

.avatar.animate-bounce {
    animation: avatarBounce 1s ease-in-out;
}

/* Glow */
@keyframes avatarGlow {
    0%, 100% {
        box-shadow: var(--avatar-glass-shadow),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }
    50% {
        box-shadow: var(--avatar-glass-shadow),
                    0 0 20px rgba(255, 255, 255, 0.5),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }
}

.avatar.animate-glow {
    animation: avatarGlow 2s ease-in-out infinite;
}

/* Rotate */
@keyframes avatarRotate {
    from {
        transform: rotate(0deg);
    }
    to {
        transform: rotate(360deg);
    }
}

.avatar.animate-rotate {
    animation: avatarRotate 20s linear infinite;
}

/* Shake */
@keyframes avatarShake {
    0%, 100% {
        transform: translateX(0);
    }
    10%, 30%, 50%, 70%, 90% {
        transform: translateX(-2px);
    }
    20%, 40%, 60%, 80% {
        transform: translateX(2px);
    }
}

.avatar.animate-shake {
    animation: avatarShake 0.5s ease-in-out;
}

/* ========================================
   RESPONSIVE
   ======================================== */
@media (max-width: 640px) {
    :root {
        --avatar-size-xs: 20px;
        --avatar-size-sm: 28px;
        --avatar-size-md: 36px;
        --avatar-size-lg: 48px;
        --avatar-size-xl: 60px;
        --avatar-size-xxl: 80px;
    }
    
    .avatar-badge {
        font-size: 10px;
        min-width: 18px;
        height: 18px;
        line-height: 18px;
        padding: 0 4px;
    }
    
    .avatar-group .avatar {
        border-width: 1px;
    }
}

/* Support tactile */
@media (hover: none) {
    .avatar[onclick]:active,
    .avatar[style*="cursor: pointer"]:active {
        transform: scale(0.95);
    }
}

/* ========================================
   THÈMES
   ======================================== */

/* Thème sombre */
.dark .avatar.glassmorphism,
[data-theme="dark"] .avatar.glassmorphism {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.1);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.dark .avatar-group .avatar,
[data-theme="dark"] .avatar-group .avatar {
    border-color: #1f2937;
}

/* ========================================
   ACCESSIBILITÉ
   ======================================== */

/* Focus visible */
.avatar:focus-visible {
    outline: 2px solid #3b82f6;
    outline-offset: 2px;
}

/* Mode contraste élevé */
@media (prefers-contrast: high) {
    .avatar {
        border-width: 2px;
    }
    
    .avatar-status,
    .avatar-badge {
        border-width: 3px;
        font-weight: 800;
    }
}

/* Préférences de mouvement réduit */
@media (prefers-reduced-motion: reduce) {
    .avatar,
    .avatar * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* ========================================
   SUPPORT NAVIGATEURS
   ======================================== */

/* Fallback pour navigateurs sans backdrop-filter */
@supports not (backdrop-filter: blur(20px)) {
    .avatar.glassmorphism {
        background: rgba(255, 255, 255, 0.95);
    }
    
    .dark .avatar.glassmorphism {
        background: rgba(30, 30, 30, 0.95);
    }
    
    .avatar-badge,
    .avatar-status {
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
}

/* Fallback pour clip-path hexagon */
@supports not (clip-path: polygon(0 0)) {
    .avatar-hexagon {
        border-radius: 20%;
    }
}